import{r as g,j as e,u as S,e as T,b as m,B as x,w as f}from"./index-BwO6VKef.js";import{u as w,c as C}from"./ThemeProvider-CfCpptdN.js";const v=g.forwardRef(({bsPrefix:d,bg:n="primary",pill:p=!1,text:h,className:u,as:j="span",...o},c)=>{const a=w(d,"badge");return e.jsx(j,{ref:c,...o,className:C(u,a,p&&"rounded-pill",h&&`text-${h}`,n&&`bg-${n}`)})});v.displayName="Badge";const P=g.forwardRef(({bsPrefix:d,className:n,striped:p,bordered:h,borderless:u,hover:j,size:o,variant:c,responsive:a,...b},$)=>{const r=w(d,"table"),R=C(n,r,c&&`${r}-${c}`,o&&`${r}-${o}`,p&&`${r}-${typeof p=="string"?`striped-${p}`:"striped"}`,h&&`${r}-bordered`,u&&`${r}-borderless`,j&&`${r}-hover`),y=e.jsx("table",{...b,className:R,ref:$});if(a){let N=`${r}-responsive`;return typeof a=="string"&&(N=`${N}-${a}`),e.jsx("div",{className:N,children:y})}return y});P.displayName="Table";function k(){const[d,n]=g.useState("inQueue"),{user:p}=S(),{pendingRecipe:h,setRecipes:u,setDeclinedRecipe:j,getNotifications:o,getPendingRecipe:c,setPendingRecipe:a,setAcceptedRecipe:b,getAcceptedRecipes:$,getDeclinedRecipes:r,acceptedRecipe:R,declinedRecipe:y,recipes:N}=g.useContext(T);g.useEffect(()=>{c(),$(),r()},[]);const I=async t=>{try{a(i=>i.filter(s=>s.id!==t.id)),b(i=>[...i,t]),u(i=>[...i,t]),await m.delete(`${x}${f.GET_PENDING_RECIPES}/${t.id}`),await m.post(`${x}${f.GET_ALL}`,t),await m.post(`${x}${f.GET_ACCEPTED_RECIPES}`,t),await Promise.all([c(),$()]),await m.post(`${x}/notifications`,{userId:t.userId,message:`Your recipe '${t.name}' has been accepted.`,status:"unread"}),await o(t.userId)}catch(i){console.error("Approval failed:",i),a(s=>[...s,t]),b(s=>s.filter(l=>l.id!==t.id)),u(s=>s.filter(l=>l.id!==t.id))}},A=async t=>{try{await m.delete(`${x}${f.GET_PENDING_RECIPES}/${t.id}`),await m.post(`${x}${f.GET_DECLINED_RECIPES}`,t),a(i=>i.filter(s=>s.id!==t.id)),j(i=>[...i,t]),await c(),await r(),await m.post(`${x}/notifications`,{userId:t.userId,message:`Your recipe '${t.name}' has been rejected.`,status:"unread"}),await o(t.userId)}catch(i){console.error("Rejection failed:",i),alert("Failed to reject recipe. Please try again."),a(s=>[...s,t]),j(s=>s.filter(l=>l.id!==t.id))}},E=(t,i="pending")=>e.jsxs(P,{responsive:!0,bordered:!0,hover:!0,className:"text-center align-middle",children:[e.jsx("thead",{className:"table-light",children:e.jsxs("tr",{children:[e.jsx("th",{children:"#"}),e.jsx("th",{children:"Recipe"}),e.jsx("th",{children:"Cuisine"}),e.jsx("th",{children:"Servings"}),e.jsx("th",{children:"Creator"}),e.jsx("th",{children:"Status"}),i==="pending"&&e.jsx("th",{children:"Actions"})]})}),e.jsxs("tbody",{children:[t.map((s,l)=>e.jsxs("tr",{children:[e.jsx("td",{children:l+1}),e.jsx("td",{children:e.jsxs("div",{className:"d-flex align-items-center justify-content-center gap-2",children:[e.jsx("img",{src:s.image,alt:s.name,className:"rounded-circle",style:{width:"50px",height:"50px",objectFit:"cover"}}),e.jsx("span",{children:s.name})]})}),e.jsx("td",{children:s.cuisine}),e.jsx("td",{children:s.servings}),e.jsx("td",{children:s.creator||"Unknown"}),e.jsx("td",{children:e.jsx(v,{bg:i==="pending"?"warning":i==="accepted"?"success":"danger",children:i==="pending"?"Processing":i==="accepted"?"Accepted":"Declined"})}),i==="pending"&&e.jsxs("td",{children:[e.jsx("i",{className:"fa fa-check-circle text-success me-3",style:{cursor:"pointer",fontSize:"1.2rem"},onClick:()=>I(s)}),e.jsx("i",{className:"fa fa-times-circle text-danger",style:{cursor:"pointer",fontSize:"1.2rem"},onClick:()=>A(s)})]})]},s.id||l)),t.length===0&&e.jsx("tr",{children:e.jsxs("td",{colSpan:i==="pending"?7:6,className:"text-muted",children:["No ",i," requests."]})})]})]});return e.jsxs("div",{className:"container my-4",children:[e.jsxs("div",{className:"d-flex border-bottom mb-3",children:[e.jsx("div",{className:`me-4 fw-bold ${d==="accepted"?"text-primary border-bottom border-primary pb-2":"text-muted"}`,onClick:()=>n("accepted"),style:{cursor:"pointer"},children:"Accepted"}),e.jsx("div",{className:`me-4 fw-bold ${d==="inQueue"?"text-primary border-bottom border-primary pb-2":"text-muted"}`,onClick:()=>n("inQueue"),style:{cursor:"pointer"},children:"In Queue"}),e.jsx("div",{className:`fw-bold ${d==="declined"?"text-primary border-bottom border-primary pb-2":"text-muted"}`,onClick:()=>n("declined"),style:{cursor:"pointer"},children:"Declined"})]}),d==="inQueue"&&E(h,"pending"),d==="accepted"&&E(R,"accepted"),d==="declined"&&E(y,"declined")]})}export{k as default};
