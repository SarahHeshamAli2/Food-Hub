import{t as R,j as e,r as c,v as S,e as k,u as I,d as D,q as A,s as L,y as B,w as T}from"./index-BfOoBtXQ.js";import{P as i}from"./index-2J7pJPoi.js";import{I as U}from"./IngredientCard-CVbCV0KJ.js";import"./ThemeProvider-DO1M_6sK.js";import"./divWithClassName-DXE6DARc.js";const q="_container_1o000_1",$="_title_1o000_7",O="_list_1o000_15",E="_item_1o000_22",P="_actionsContainer_1o000_39",V="_menuBtn_1o000_52",z="_favoriteBtn_1o000_53",Y="_notFavorited_1o000_83",Q="_emptyState_1o000_92",X="_emptyIcon_1o000_99",G="_modalOverlay_1o000_105",H="_modal_1o000_105",J="_modalActions_1o000_127",K="_confirmButton_1o000_133",W="_cancelButton_1o000_142",Z="_contextMenu_1o000_169",ee="_contextMenuItem_1o000_185",te="_seeMoreButton_1o000_208",s={container:q,title:$,list:O,item:E,actionsContainer:P,menuBtn:V,favoriteBtn:z,notFavorited:Y,emptyState:Q,emptyIcon:X,modalOverlay:G,modal:H,modalActions:J,confirmButton:K,cancelButton:W,contextMenu:Z,contextMenuItem:ee,seeMoreButton:te},se=({recipeId:o,onDelete:r,closeMenu:a})=>{const x=R(),u=()=>{a(),r&&r(o)},d=()=>{x(`/add-recipe/${o}`),a()};return e.jsx("div",{children:e.jsxs("div",{className:`${s.contextMenu} flex flex-col `,children:[e.jsx("button",{onClick:u,className:s.contextMenuItem,children:"Delete"}),e.jsx("button",{onClick:d,className:s.contextMenuItem,children:"Update"})]})})};M.propTypes={recipes:i.array.isRequired,isSignedIn:i.bool.isRequired,isRegularUser:i.bool.isRequired,isAdmin:i.bool.isRequired,favoriteIds:i.array.isRequired,onToggleFavorite:i.func,onDelete:i.func,onUpdate:i.func,userId:i.string,isLoading:i.bool};function M({recipes:o,isSignedIn:r,isRegularUser:a,isAdmin:x,favoriteIds:u,onToggleFavorite:d,onDelete:g,onUpdate:y,userId:N,isLoading:b}){const[m,_]=c.useState(null),[h,f]=c.useState(9),[v,C]=c.useState(""),j=R(),w=(t,n)=>{console.log("Clicked target:",n.target),n.target.closest(`.${s.actionsContainer}`)||j(`/recipes/${t}`)},F=t=>{_(m===t?null:t)},l=o.filter(t=>t.name.toLowerCase().includes(v.toLowerCase()));return e.jsxs("div",{className:s.container,children:[e.jsx("h2",{className:s.title,children:"Explore Recipes"}),e.jsx("div",{className:"flex justify-center mb-6",children:e.jsxs("div",{className:"relative w-full max-w-md",children:[e.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400",children:e.jsx(S,{})}),e.jsx("input",{type:"text",placeholder:"Search recipes...",value:v,onChange:t=>C(t.target.value),className:"w-full pl-10 pr-4 py-2 rounded-full border border-gray-300 focus:outline-none focus:ring-2 focus:ring-[#FF7F50] focus:border-transparent transition-all duration-300"}),v&&l.length>0&&e.jsx("ul",{className:"absolute left-0 right-0 bg-white border border-gray-200 mt-2 rounded-lg shadow-lg z-10 overflow-hidden",children:l.slice(0,4).map(t=>e.jsx("li",{className:"px-4 py-2 text-gray-700 hover:bg-orange-200 hover:text-black-800 transition-colors duration-150 cursor-pointer",onClick:()=>j(`/recipes/${t.id}`),children:t.name},t.id))})]})}),b?e.jsx(k,{}):e.jsx(e.Fragment,{children:l.length===0?e.jsxs("div",{className:s.emptyState,children:[e.jsx("div",{className:s.emptyIcon,children:e.jsx("i",{className:"far fa-utensils"})}),e.jsx("h3",{children:"No recipes found"}),e.jsx("p",{children:"Try a different search term."})]}):e.jsxs(e.Fragment,{children:[r&&e.jsx("div",{className:"flex justify-end mb-4",children:e.jsx("button",{onClick:()=>j("/add-recipe/new-recipe"),className:"bg-[#FF7F50] hover:bg-orange-500 text-white px-4 py-2 rounded-full font-semibold shadow transition duration-300",children:"+ Add New Recipe"})}),e.jsx("ul",{className:s.list,children:l.slice(0,h).map(t=>e.jsx("li",{className:s.item,onClick:n=>w(t.id,n),children:e.jsx(U,{recipe:t,children:e.jsxs("div",{className:s.actionsContainer,onClick:n=>n.stopPropagation(),children:[!x&&r&&e.jsx("button",{onClick:()=>d(t.id),className:`${s.favoriteBtn} ${u.includes(t.id)?"":s.notFavorited}`,"aria-label":u.includes(t.id)?"Remove from favorites":"Add to favorites",children:e.jsx("i",{className:u.includes(t.id)?"fas fa-heart":"far fa-heart"})}),(x||a&&t.userId===N)&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:s.menuBtn,onClick:()=>F(t.id),"aria-expanded":m===t.id,children:e.jsx("i",{className:"fas fa-ellipsis-v"})}),m===t.id&&e.jsx(se,{recipeId:t.id,onDelete:g,onUpdate:y,closeMenu:()=>_(null)})]})]})})},t.id))}),l.length>h&&e.jsx("button",{className:s.seeMoreButton,onClick:()=>f(t=>Math.min(t+12,l.length)),children:h>=l.length?"No more recipes":"See More"})]})})]})}function ce(){const{user:o,isLoaded:r,isSignedIn:a}=I(),{recipes:x,deleteRecipe:u}=c.useContext(D),[d,g]=c.useState([]),[y,N]=c.useState(!0),[b,m]=c.useState(!1),[_,h]=c.useState(null),f=a&&(o==null?void 0:o.id)==="user_2xugrL6VB89nr5uplXDzYIsrlQq",v=a&&!f,C=o==null?void 0:o.id;c.useEffect(()=>{async function n(){if(r&&a){const p=await A(o.id);g(p)}N(!1)}n()},[r,a,o,f]);const j=async n=>{if(!(!a||f))try{d.includes(n)?(await L(o.id,n),g(d.filter(p=>p!==n)),B.info("Recipe removed from favorites")):(await T(o.id,n),g([...d,n]),B.success("Recipe added to favorites"))}catch(p){B.error("Something went wrong"),console.error(p)}},w=n=>{h(n),m(!0)},F=()=>{_&&(u(_),m(!1),h(null))},l=()=>{m(!1),h(null)},t=n=>{alert("Update recipe "+n)};return e.jsxs(e.Fragment,{children:[e.jsx(M,{recipes:x,isSignedIn:a,isAdmin:f,isRegularUser:v,favoriteIds:d,onToggleFavorite:j,onDelete:w,onUpdate:t,userId:C,isLoading:y}),b&&e.jsx("div",{className:s.modalOverlay,children:e.jsxs("div",{className:s.modal,children:[e.jsx("p",{children:"Are you sure you want to delete this recipe?"}),e.jsxs("div",{className:s.modalActions,children:[e.jsx("button",{onClick:F,className:s.confirmButton,children:"Yes, Delete"}),e.jsx("button",{onClick:l,className:s.cancelButton,children:"Cancel"})]})]})})]})}export{ce as default};
