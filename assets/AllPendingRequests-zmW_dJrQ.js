import{r as g,j as e,u as S,d as T,b as m,B as x,x as f}from"./index-BfOoBtXQ.js";import{u as w,c as C}from"./ThemeProvider-DO1M_6sK.js";const v=g.forwardRef(({bsPrefix:d,bg:n="primary",pill:p=!1,text:h,className:u,as:j="span",...o},c)=>{const a=w(d,"badge");return e.jsx(j,{ref:c,...o,className:C(u,a,p&&"rounded-pill",h&&`text-${h}`,n&&`bg-${n}`)})});v.displayName="Badge";const P=g.forwardRef(({bsPrefix:d,className:n,striped:p,bordered:h,borderless:u,hover:j,size:o,variant:c,responsive:a,...b},$)=>{const i=w(d,"table"),R=C(n,i,c&&`${i}-${c}`,o&&`${i}-${o}`,p&&`${i}-${typeof p=="string"?`striped-${p}`:"striped"}`,h&&`${i}-bordered`,u&&`${i}-borderless`,j&&`${i}-hover`),y=e.jsx("table",{...b,className:R,ref:$});if(a){let N=`${i}-responsive`;return typeof a=="string"&&(N=`${N}-${a}`),e.jsx("div",{className:N,children:y})}return y});P.displayName="Table";function k(){const[d,n]=g.useState("inQueue"),{user:p}=S(),{pendingRecipe:h,setRecipes:u,setDeclinedRecipe:j,getNotifications:o,getPendingRecipe:c,setPendingRecipe:a,setAcceptedRecipe:b,getAcceptedRecipes:$,getDeclinedRecipes:i,acceptedRecipe:R,declinedRecipe:y,recipes:N}=g.useContext(T);g.useEffect(()=>{c(),$(),i()},[]);const I=async s=>{try{a(r=>r.filter(t=>t.id!==s.id)),b(r=>[...r,s]),u(r=>[...r,s]),await m.delete(`${x}${f.GET_PENDING_RECIPES}/${s.id}`),await m.post(`${x}${f.GET_ALL}`,s),await m.post(`${x}${f.GET_ACCEPTED_RECIPES}`,s),await Promise.all([c(),$()]),await m.post(`${x}/notifications`,{userId:s.userId,message:`Your recipe '${s.name}' has been accepted.`,status:"unread"}),await o(s.userId)}catch(r){console.error("Approval failed:",r),a(t=>[...t,s]),b(t=>t.filter(l=>l.id!==s.id)),u(t=>t.filter(l=>l.id!==s.id))}},A=async s=>{try{a(r=>r.filter(t=>t.id!==s.id)),j(r=>[...r,s]),await m.post(`${x}${f.GET_DECLINED_RECIPES}`,s),await m.delete(`${x}${f.GET_PENDING_RECIPES}/${s.id}`),await Promise.all([c(),i()]),await m.post(`${x}/notifications`,{userId:s.userId,message:`Your recipe '${s.name}' has been rejected.`,status:"unread"}),await o(s.userId)}catch(r){console.error("Rejection failed:",r),a(t=>[...t,s]),j(t=>t.filter(l=>l.id!==s.id)),alert("Failed to reject recipe. Please try again.")}},E=(s,r="pending")=>e.jsxs(P,{responsive:!0,bordered:!0,hover:!0,className:"text-center align-middle",children:[e.jsx("thead",{className:"table-light",children:e.jsxs("tr",{children:[e.jsx("th",{children:"#"}),e.jsx("th",{children:"Recipe"}),e.jsx("th",{children:"Cuisine"}),e.jsx("th",{children:"Servings"}),e.jsx("th",{children:"Creator"}),e.jsx("th",{children:"Status"}),r==="pending"&&e.jsx("th",{children:"Actions"})]})}),e.jsxs("tbody",{children:[s.map((t,l)=>e.jsxs("tr",{children:[e.jsx("td",{children:l+1}),e.jsx("td",{children:e.jsxs("div",{className:"d-flex align-items-center justify-content-center gap-2",children:[e.jsx("img",{src:t.image,alt:t.name,className:"rounded-circle",style:{width:"50px",height:"50px",objectFit:"cover"}}),e.jsx("span",{children:t.name})]})}),e.jsx("td",{children:t.cuisine}),e.jsx("td",{children:t.servings}),console.log(t.creator),e.jsx("td",{children:t.creator||"Unknown"}),e.jsx("td",{children:e.jsx(v,{bg:r==="pending"?"warning":r==="accepted"?"success":"danger",children:r==="pending"?"Processing":r==="accepted"?"Accepted":"Declined"})}),r==="pending"&&e.jsxs("td",{children:[e.jsx("i",{className:"fa fa-check-circle text-success me-3",style:{cursor:"pointer",fontSize:"1.2rem"},onClick:()=>I(t)}),e.jsx("i",{className:"fa fa-times-circle text-danger",style:{cursor:"pointer",fontSize:"1.2rem"},onClick:()=>A(t)})]})]},t.id||l)),s.length===0&&e.jsx("tr",{children:e.jsxs("td",{colSpan:r==="pending"?7:6,className:"text-muted",children:["No ",r," requests."]})})]})]});return e.jsxs("div",{className:"container my-4",children:[e.jsxs("div",{className:"d-flex border-bottom mb-3",children:[e.jsx("div",{className:`me-4 fw-bold ${d==="accepted"?"text-primary border-bottom border-primary pb-2":"text-muted"}`,onClick:()=>n("accepted"),style:{cursor:"pointer"},children:"Accepted"}),e.jsx("div",{className:`me-4 fw-bold ${d==="inQueue"?"text-primary border-bottom border-primary pb-2":"text-muted"}`,onClick:()=>n("inQueue"),style:{cursor:"pointer"},children:"In Queue"}),e.jsx("div",{className:`fw-bold ${d==="declined"?"text-primary border-bottom border-primary pb-2":"text-muted"}`,onClick:()=>n("declined"),style:{cursor:"pointer"},children:"Declined"})]}),d==="inQueue"&&E(h,"pending"),d==="accepted"&&E(R,"accepted"),d==="declined"&&E(y,"declined")]})}export{k as default};
