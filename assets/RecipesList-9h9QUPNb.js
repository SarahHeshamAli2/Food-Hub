import{t as F,j as e,r as m,v as I,e as S,u as k,d as B,q as L,s as U,y as C,w as D}from"./index-BuM992-L.js";import{P as a}from"./index-D3cs-l7P.js";import{I as T}from"./IngredientCard-DrO3pmVU.js";import{D as q}from"./DeleteModal-fZXXoc-y.js";import"./ThemeProvider-Dxv97OvZ.js";import"./divWithClassName-HNBRu_D1.js";const $="_container_4migs_1",A="_title_4migs_13",E="_list_4migs_29",P="_item_4migs_43",V="_actionsContainer_4migs_77",z="_menuBtn_4migs_103",O="_favoriteBtn_4migs_105",Q="_notFavorited_4migs_165",X="_emptyState_4migs_183",Y="_emptyIcon_4migs_197",G="_contextMenu_4migs_337",H="_contextMenuItem_4migs_369",J="_seeMoreButton_4migs_415",n={container:$,title:A,list:E,item:P,actionsContainer:V,menuBtn:z,favoriteBtn:O,notFavorited:Q,emptyState:X,emptyIcon:Y,contextMenu:G,contextMenuItem:H,seeMoreButton:J},K=({recipeId:s,onDelete:r,closeMenu:o})=>{const g=F(),c=()=>{o(),r&&r(s)},l=()=>{g(`/add-recipe/${s}`),o()};return e.jsx("div",{children:e.jsxs("div",{className:`${n.contextMenu} flex flex-col `,children:[e.jsx("button",{onClick:c,className:n.contextMenuItem,children:"Delete"}),e.jsx("button",{onClick:l,className:n.contextMenuItem,children:"Update"})]})})};w.propTypes={recipes:a.array.isRequired,isSignedIn:a.bool.isRequired,isRegularUser:a.bool.isRequired,isAdmin:a.bool.isRequired,favoriteIds:a.array.isRequired,onToggleFavorite:a.func,onDelete:a.func,onUpdate:a.func,userId:a.string,isLoading:a.bool};function w({recipes:s,isSignedIn:r,isRegularUser:o,isAdmin:g,favoriteIds:c,onToggleFavorite:l,onDelete:h,onUpdate:_,userId:y,isLoading:x}){const[p,j]=m.useState(null),[v,b]=m.useState(9),[i,d]=m.useState(""),N=F(),M=(t,f)=>{console.log("Clicked target:",f.target),f.target.closest(`.${n.actionsContainer}`)||N(`/recipes/${t}`)},R=t=>{j(p===t?null:t)},u=s.filter(t=>t.name.toLowerCase().includes(i.toLowerCase()));return e.jsxs("div",{className:n.container,children:[e.jsx("h2",{className:n.title,children:"Explore Recipes"}),e.jsx("div",{className:"flex justify-center mb-6",children:e.jsxs("div",{className:"relative w-full max-w-md",children:[e.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400",children:e.jsx(I,{})}),e.jsx("input",{type:"text",placeholder:"Search recipes...",value:i,onChange:t=>d(t.target.value),className:"w-full pl-10 pr-4 py-2 rounded-full border border-gray-300 focus:outline-none focus:ring-2 focus:ring-[#FF7F50] focus:border-transparent transition-all duration-300"}),i&&u.length>0&&e.jsx("ul",{className:"absolute left-0 right-0 bg-white border border-gray-200 mt-2 rounded-lg shadow-lg z-10 overflow-hidden",children:u.slice(0,4).map(t=>e.jsx("li",{className:"px-4 py-2 text-gray-700 hover:bg-orange-200 hover:text-black-800 transition-colors duration-150 cursor-pointer",onClick:()=>N(`/recipes/${t.id}`),children:t.name},t.id))})]})}),x?e.jsx(S,{}):e.jsx(e.Fragment,{children:u.length===0?e.jsxs("div",{className:n.emptyState,children:[e.jsx("div",{className:n.emptyIcon,children:e.jsx("i",{className:"far fa-utensils"})}),e.jsx("h3",{children:"No recipes found"}),e.jsx("p",{children:"Try a different search term."})]}):e.jsxs(e.Fragment,{children:[r&&e.jsx("div",{className:"flex justify-end mb-4",children:e.jsx("button",{onClick:()=>N("/add-recipe/new-recipe"),className:"bg-[#FF7F50] hover:bg-orange-500 text-white px-4 py-2 rounded-full font-semibold shadow transition duration-300",children:"+ Add New Recipe"})}),e.jsx("ul",{className:n.list,children:u.slice(0,v).map(t=>e.jsx("li",{className:n.item,onClick:f=>M(t.id,f),children:e.jsx(T,{recipe:t,children:e.jsxs("div",{className:n.actionsContainer,onClick:f=>f.stopPropagation(),children:[!g&&r&&e.jsx("button",{onClick:()=>l(t.id),className:`${n.favoriteBtn} ${c.includes(t.id)?"":n.notFavorited}`,"aria-label":c.includes(t.id)?"Remove from favorites":"Add to favorites",children:e.jsx("i",{className:c.includes(t.id)?"fas fa-heart":"far fa-heart"})}),(g||o&&t.userId===y)&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:n.menuBtn,onClick:()=>R(t.id),"aria-expanded":p===t.id,children:e.jsx("i",{className:"fas fa-ellipsis-v"})}),p===t.id&&e.jsx(K,{recipeId:t.id,onDelete:h,onUpdate:_,closeMenu:()=>j(null)})]})]})})},t.id))}),u.length>v&&e.jsx("button",{className:n.seeMoreButton,onClick:()=>b(t=>Math.min(t+12,u.length)),children:v>=u.length?"No more recipes":"See More"})]})})]})}function oe(){const{user:s,isLoaded:r,isSignedIn:o}=k(),{recipes:g,handleDelete:c}=m.useContext(B),[l,h]=m.useState([]),[_,y]=m.useState(!0),x=o&&(s==null?void 0:s.id)==="user_2xugrL6VB89nr5uplXDzYIsrlQq",p=o&&!x,j=s==null?void 0:s.id;m.useEffect(()=>{async function i(){if(r&&o){const d=await L(s.id);h(d)}y(!1)}i()},[r,o,s,x]);const v=async i=>{if(!(!o||x))try{l.includes(i)?(await U(s.id,i),h(l.filter(d=>d!==i)),C.info("Recipe removed from favorites")):(await D(s.id,i),h([...l,i]),C.success("Recipe added to favorites"))}catch(d){C.error("Something went wrong"),console.error(d)}},b=i=>{alert("Update recipe "+i)};return e.jsxs(e.Fragment,{children:[e.jsx(w,{recipes:g,isSignedIn:o,isAdmin:x,isRegularUser:p,favoriteIds:l,onToggleFavorite:v,onDelete:c,onUpdate:b,userId:j,isLoading:_}),e.jsx(q,{})]})}export{oe as default};
